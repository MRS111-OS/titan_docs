<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Localization and Navigation - Titan Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Localization and Navigation";
        var mkdocs_page_input_path = "navigation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Titan Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../hardware/">Hardware Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../software/">Software Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bringup/">Robot Bringup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../visualization/">Visualization</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../mapping/">Mapping</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Localization and Navigation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#localization-concepts">Localization Concepts</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#what-is-localization">What is Localization?</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#inputs-used-for-localization">Inputs Used for Localization</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#launching-localization-and-navigation">Launching Localization and Navigation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#initial-pose-estimation">Initial Pose Estimation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#verifying-localization">Verifying Localization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#navigation-overview">Navigation Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sending-navigation-goals">Sending Navigation Goals</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#costmaps">Costmaps</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#global-costmap">Global Costmap</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#local-costmap">Local Costmap</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#navigation-behavior">Navigation Behavior</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#common-localization-issues">Common Localization Issues</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#common-navigation-issues">Common Navigation Issues</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#safety-guidelines">Safety Guidelines</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#performance-tuning-tips">Performance Tuning Tips</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../networking/">Networking and Remote Access</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../troubleshoot/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Titan Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Localization and Navigation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="localization-navigation">Localization &amp; Navigation</h1>
<h2 id="overview">Overview</h2>
<p>Localization and navigation allow Titan Robot to estimate its position within a known map and autonomously move to target locations.<br />
This section explains how localization and navigation are performed using <strong>ROS 2 Navigation (Nav2)</strong>.</p>
<p><img alt="nav2" src="../images/nav2_logo.png" /></p>
<p>Titan Robot relies entirely on Nav2 for:
- Localization using a pre-built map
- Global and local path planning
- Obstacle avoidance
- Velocity command generation</p>
<hr />
<p><img alt="nav2" src="../images/nav2.png" /></p>
<h2 id="localization-concepts">Localization Concepts</h2>
<h3 id="what-is-localization">What is Localization?</h3>
<p>Localization is the process of estimating the robotâ€™s pose (x, y, Î¸) within a known map.<br />
Once a map is provided, the robot continuously estimates its position using sensor data and odometry.</p>
<p>Nav2 uses a probabilistic localization approach (AMCL) to localize the robot on the map.</p>
<hr />
<h3 id="inputs-used-for-localization">Inputs Used for Localization</h3>
<table>
<thead>
<tr>
<th>Input</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td>Map</td>
<td>Pre-built occupancy grid</td>
</tr>
<tr>
<td>Laser scans</td>
<td>2D LIDAR (<code>/scan</code>)</td>
</tr>
<tr>
<td>Odometry</td>
<td>Encoder-based odometry (<code>/odom</code>)</td>
</tr>
<tr>
<td>TF</td>
<td>Coordinate frame transforms</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="prerequisites">Prerequisites</h2>
<p>Before starting localization and navigation, ensure that:</p>
<ul>
<li>A valid map file (.yaml and .pgm) is available</li>
<li>Robot bringup is running</li>
<li>LIDAR is publishing scan data</li>
<li>Odometry is being published correctly</li>
</ul>
<hr />
<h2 id="launching-localization-and-navigation">Launching Localization and Navigation</h2>
<p>Localization and navigation are launched together using Nav2 bringup.</p>
<p>Run the following command:</p>
<pre><code class="language-bash">ros2 launch nav2_bringup bringup.launch.py map:=/absolute/path/to/map.yaml
</code></pre>
<p>This launch file starts:
- Map server
- Localization (AMCL)
- Global planner
- Local controller
- Costmaps
- Behavior tree navigator</p>
<hr />
<h2 id="initial-pose-estimation">Initial Pose Estimation</h2>
<p><img alt="goal" src="../images/goal.png" /></p>
<p>After Nav2 starts, the robot must be given an initial pose.</p>
<p>In RViz2:</p>
<ol>
<li>Set Fixed Frame to <code>map</code></li>
<li>Select the <strong>2D Pose Estimate</strong> tool</li>
<li>Click on the robotâ€™s approximate position on the map</li>
<li>Set the robotâ€™s orientation</li>
</ol>
<p>The localization system will converge to the correct pose within a few seconds.</p>
<hr />
<h2 id="verifying-localization">Verifying Localization</h2>
<p>Localization is working correctly if:</p>
<ul>
<li>The robot model aligns with the map</li>
<li>Laser scans match map walls</li>
<li>Small movements update the pose smoothly</li>
<li>The pose does not jump unexpectedly</li>
</ul>
<hr />
<h2 id="navigation-overview">Navigation Overview</h2>
<p>Navigation allows the robot to autonomously move to a target pose while avoiding obstacles.</p>
<p>Nav2 handles:
- Global path planning
- Local obstacle avoidance
- Velocity command generation</p>
<p>Velocity commands are published to the <code>/cmd_vel</code> topic and sent to the ESP32.</p>
<hr />
<h2 id="sending-navigation-goals">Sending Navigation Goals</h2>
<p>To send a navigation goal:</p>
<ol>
<li>Open RViz2</li>
<li>Set Fixed Frame to <code>map</code></li>
<li>Select <strong>2D Goal Pose</strong></li>
<li>Click on the desired target location</li>
<li>Set the target orientation</li>
</ol>
<p>Nav2 will compute a path and drive the robot to the goal.</p>
<hr />
<h2 id="costmaps">Costmaps</h2>
<p><img alt="costmap" src="../images/costmap.jpeg" /></p>
<h3 id="global-costmap">Global Costmap</h3>
<ul>
<li>Based on the static map</li>
<li>Used for long-range path planning</li>
<li>Represents static obstacles</li>
</ul>
<h3 id="local-costmap">Local Costmap</h3>
<ul>
<li>Built from real-time sensor data</li>
<li>Used for obstacle avoidance</li>
<li>Updates continuously during navigation</li>
</ul>
<hr />
<h2 id="navigation-behavior">Navigation Behavior</h2>
<p><img alt="path" src="../images/path.jpeg" /></p>
<p>During navigation, the robot:</p>
<ul>
<li>Plans a path to the goal</li>
<li>Continuously updates the path</li>
<li>Avoids static and dynamic obstacles</li>
<li>Stops when the goal is reached</li>
</ul>
<hr />
<h2 id="common-localization-issues">Common Localization Issues</h2>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Possible Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>Robot pose jumps</td>
<td>Incorrect initial pose</td>
<td>Reset pose using RViz</td>
</tr>
<tr>
<td>Slow convergence</td>
<td>Odometry drift</td>
<td>Improve encoder calibration</td>
</tr>
<tr>
<td>Laser mismatch</td>
<td>Incorrect TF frames</td>
<td>Verify LIDAR transforms</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="common-navigation-issues">Common Navigation Issues</h2>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Possible Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>Robot does not move</td>
<td>No velocity commands</td>
<td>Check Nav2 nodes and <code>/cmd_vel</code></td>
</tr>
<tr>
<td>Oscillations</td>
<td>Aggressive controller tuning</td>
<td>Tune controller parameters</td>
</tr>
<tr>
<td>Collisions</td>
<td>Incorrect costmap setup</td>
<td>Adjust footprint and inflation</td>
</tr>
<tr>
<td>No path generated</td>
<td>Localization failure</td>
<td>Verify map and pose accuracy</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="safety-guidelines">Safety Guidelines</h2>
<ul>
<li>Test navigation in open environments</li>
<li>Limit maximum speed during initial testing</li>
<li>Always monitor the robot during autonomous runs</li>
<li>Keep an emergency stop accessible</li>
</ul>
<hr />
<h2 id="performance-tuning-tips">Performance Tuning Tips</h2>
<ul>
<li>Ensure odometry is accurate before tuning Nav2</li>
<li>Verify TF tree correctness</li>
<li>Reduce costmap resolution if CPU usage is high</li>
<li>Avoid running heavy perception nodes simultaneously</li>
</ul>
<p>Your robot is now fully capable of localization and autonomous navigation using Nav2 ðŸš€</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../mapping/" class="btn btn-neutral float-left" title="Mapping"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../networking/" class="btn btn-neutral float-right" title="Networking and Remote Access">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../mapping/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../networking/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
