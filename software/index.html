<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Software Architecture - Titan Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Software Architecture";
        var mkdocs_page_input_path = "software.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Titan Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../hardware/">Hardware Architecture</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Software Architecture</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#high-level-architecture">High-Level Architecture</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#high-level-ros-2-layer-raspberry-pi">High-Level ROS 2 Layer (Raspberry Pi)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#core-ros-2-components">Core ROS 2 Components</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#robot-bringup">Robot Bringup</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#navigation-stack">Navigation Stack</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#slam-and-localization">SLAM and Localization</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#perception-variant-dependent">Perception (Variant Dependent)</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ros-2-communication-interfaces">ROS 2 Communication Interfaces</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#key-topics">Key Topics</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#low-level-firmware-layer-esp32">Low-Level Firmware Layer (ESP32)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#firmware-overview">Firmware Overview</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#firmware-responsibilities">Firmware Responsibilities</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#odometry-computation">Odometry Computation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#velocity-command-flow">Velocity Command Flow</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#serial-communication">Serial Communication</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ros-2-odometry-publishing">ROS 2 Odometry Publishing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#timing-and-synchronization">Timing and Synchronization</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bringup/">Robot Bringup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../visualization/">Visualization</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../mapping/">Mapping</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../navigation/">Localization and Navigation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../simulation/">Simulation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../docker/">Titan Docker Simulation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../networking/">Networking and Remote Access</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../troubleshoot/">Troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Titan Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Software Architecture</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="software-architecture">Software Architecture</h1>
<h2 id="overview">Overview</h2>
<p>This section describes the complete software architecture of <strong>Titan Robot</strong>, including the ROS 2 system running on the main computer and the firmware running on the microcontroller. The software is designed using a layered approach that cleanly separates high-level autonomy from low-level real-time control.</p>
<p>Titan Robot uses <strong>ROS 2 Humble</strong> for all high-level robot functionality and an <strong>ESP32 microcontroller</strong> programmed using the <strong>Arduino IDE</strong> for motor control and odometry computation.</p>
<hr />
<h2 id="high-level-architecture">High-Level Architecture</h2>
<p>The software stack is divided into two main layers:</p>
<ul>
<li><strong>High-Level ROS 2 Layer (Raspberry Pi)</strong></li>
<li><strong>Low-Level Firmware Layer (ESP32)</strong></li>
</ul>
<p>These layers communicate through a serial interface.</p>
<hr />
<h2 id="high-level-ros-2-layer-raspberry-pi">High-Level ROS 2 Layer (Raspberry Pi)</h2>
<p><img alt="ROS" src="../images/ros.png" /></p>
<p>The main computer runs Ubuntu 22.04 with ROS 2 Humble and is responsible for:</p>
<ul>
<li>Robot bringup and system coordination</li>
<li>Mapping and localization</li>
<li>Autonomous navigation</li>
<li>Sensor processing</li>
<li>Visualization and user interaction</li>
</ul>
<h3 id="core-ros-2-components">Core ROS 2 Components</h3>
<h4 id="robot-bringup">Robot Bringup</h4>
<ul>
<li>Launch files initialize:</li>
<li>Robot description (URDF)</li>
<li>Sensor drivers</li>
<li>ESP32 communication node</li>
<li>RViz2 configuration</li>
</ul>
<h4 id="navigation-stack">Navigation Stack</h4>
<ul>
<li>Uses ROS 2 Navigation (Nav2)</li>
<li>Consumes:</li>
<li>Odometry data</li>
<li>Laser scan data</li>
<li>Produces:</li>
<li>Velocity commands (<code>/cmd_vel</code>)</li>
</ul>
<h4 id="slam-and-localization">SLAM and Localization</h4>
<ul>
<li>SLAM Toolbox used for:</li>
<li>Online mapping</li>
<li>Localization using pre-built maps</li>
<li>Uses laser scans and odometry as inputs</li>
</ul>
<h4 id="perception-variant-dependent">Perception (Variant Dependent)</h4>
<ul>
<li><strong>V2</strong>: Image pipeline from Pi Camera</li>
<li><strong>V3</strong>: RGB-D and depth processing from RealSense camera</li>
<li>Used for object detection and advanced perception tasks</li>
</ul>
<hr />
<h2 id="ros-2-communication-interfaces">ROS 2 Communication Interfaces</h2>
<h3 id="key-topics">Key Topics</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/cmd_vel</code></td>
<td>Subscribed</td>
<td>Velocity commands from navigation or teleop</td>
</tr>
<tr>
<td><code>/odom</code></td>
<td>Published</td>
<td>Robot odometry from encoder data</td>
</tr>
<tr>
<td><code>/scan</code></td>
<td>Published</td>
<td>2D LIDAR scan data</td>
</tr>
<tr>
<td><code>/tf</code></td>
<td>Published</td>
<td>Coordinate frame transforms</td>
</tr>
<tr>
<td><code>/camera/image</code></td>
<td>Published</td>
<td>Camera image stream (V2 / V3)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="low-level-firmware-layer-esp32">Low-Level Firmware Layer (ESP32)</h2>
<p><img alt="ESP Flow" src="../images/esp_flow.png" /></p>
<h3 id="firmware-overview">Firmware Overview</h3>
<p>The ESP32 runs custom firmware developed and flashed using the <strong>Arduino IDE</strong>.<br />
Its primary responsibility is real-time motor control and odometry estimation.</p>
<p>The firmware operates independently from ROS 2 timing constraints, ensuring stable and deterministic motor behavior.</p>
<hr />
<h2 id="firmware-responsibilities">Firmware Responsibilities</h2>
<p>The ESP32 firmware performs the following tasks:</p>
<ul>
<li>Reads wheel encoder tick counts</li>
<li>Computes wheel velocities</li>
<li>Applies PID control to motors</li>
<li>Computes robot odometry</li>
<li>Exchanges data with the Raspberry Pi via serial</li>
</ul>
<hr />
<h2 id="odometry-computation">Odometry Computation</h2>
<ol>
<li>Wheel encoders generate tick counts</li>
<li>Tick counts are converted to wheel rotation</li>
<li>Wheel rotation is used to calculate:</li>
<li>Linear displacement</li>
<li>Angular displacement</li>
<li>Robot pose (<code>x</code>, <code>y</code>, <code>Î¸</code>) is estimated using differential-drive kinematics</li>
<li>Odometry data is sent over serial to the Raspberry Pi</li>
</ol>
<hr />
<h2 id="velocity-command-flow">Velocity Command Flow</h2>
<ol>
<li>Navigation stack or teleop publishes <code>/cmd_vel</code></li>
<li>Raspberry Pi serial node sends velocity commands to ESP32</li>
<li>ESP32:</li>
<li>Converts velocity commands to wheel targets</li>
<li>Runs PID control loop</li>
<li>Updates motor PWM outputs</li>
</ol>
<hr />
<h2 id="serial-communication">Serial Communication</h2>
<ul>
<li>Bidirectional serial communication between ESP32 and Raspberry Pi</li>
<li>Data exchanged:</li>
<li>Incoming: linear and angular velocity commands</li>
<li>Outgoing: odometry and status information</li>
<li>Simple, structured protocol for reliability</li>
</ul>
<hr />
<h2 id="ros-2-odometry-publishing">ROS 2 Odometry Publishing</h2>
<p>On the Raspberry Pi:</p>
<ol>
<li>Serial data is received from ESP32</li>
<li>Encoder-based odometry is decoded</li>
<li>Odometry is published as:</li>
<li><code>/odom</code> topic</li>
<li>Corresponding TF transforms (<code>odom â†’ base_link</code>)</li>
</ol>
<p>This odometry is then used by:
- SLAM Toolbox
- Navigation Stack
- Visualization tools</p>
<hr />
<h2 id="timing-and-synchronization">Timing and Synchronization</h2>
<ul>
<li>ESP32 runs control loops at a fixed rate</li>
<li>Raspberry Pi handles ROS 2 timing</li>
<li>Time stamps are applied on the ROS 2 side</li>
<li>Sensor fusion compensates for accumulated odometry error</li>
</ul>
<p>You now have a complete understanding of Titan Robotâ€™s software architecture ðŸš€</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../hardware/" class="btn btn-neutral float-left" title="Hardware Architecture"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../bringup/" class="btn btn-neutral float-right" title="Robot Bringup">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../hardware/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../bringup/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
